<!DOCTYPE html>
<html lang="en">

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width">
<link rel="icon" href=/fav.png type="image/gif">



<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
>
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      media="print" onload="this.media='all'" />
<noscript>
  <link
          href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
          rel="stylesheet">
</noscript>


<link rel="stylesheet" href="/css/font.css" media="all">



      <script async src="https://www.googletagmanager.com/gtag/js?id=G-XHMN5CZBNV"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-XHMN5CZBNV');
        }
      </script>
<meta property="og:url" content="https://ahsan.netlify.app/post/cluster-analysis/">
  <meta property="og:site_name" content="Ahsan">
  <meta property="og:title" content="Cluster Analysis">
  <meta property="og:description" content="Explore the fascinating world of cluster analysis using R. Discover various clustering techniques, such as hierarchical clustering, k-means clustering, and more, as you delve into the process of grouping similar observations together to uncover patterns and structures in your data.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2023-07-02T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-07-02T00:00:00+00:00">
    <meta property="article:tag" content="R">
    <meta property="article:tag" content="Cluster Analysis">
    <meta property="og:image" content="https://MdAhsanulHimel.github.io/2023/07/02/cluster-analysis/cluster_analysis_preview.png">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://MdAhsanulHimel.github.io/2023/07/02/cluster-analysis/cluster_analysis_preview.png">
  <meta name="twitter:title" content="Cluster Analysis">
  <meta name="twitter:description" content="Explore the fascinating world of cluster analysis using R. Discover various clustering techniques, such as hierarchical clustering, k-means clustering, and more, as you delve into the process of grouping similar observations together to uncover patterns and structures in your data.">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"><link rel="stylesheet" href="/css/header.css" media="all">
<link rel="stylesheet" href="/css/footer.css" media="all">


<link rel="stylesheet" href="/css/theme.css" media="all">


<script defer src="/fontawesome-6/all-6.4.2.js"></script>


<style>
    :root {
        --text-color: #343a40;
        --text-secondary-color: #6c757d;
        --text-link-color: #007bff;
        --background-color: #fff;
        --secondary-background-color: #64ffda1a;
        --primary-color: #007bff;
        --secondary-color: #f8f9fa;

         
        --text-color-dark: #e4e6eb;
        --text-secondary-color-dark: #b0b3b8;
        --text-link-color-dark: #ffffff;
        --background-color-dark: #18191a;
        --secondary-background-color-dark: #212529;
        --primary-color-dark: #ffffff;
        --secondary-color-dark: #212529;
    }
    body {
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        text-align: left;
    }

    html {
        background-color: var(--background-color) !important;
    }

    body::-webkit-scrollbar {
        height: 0px;
        width: 8px;
        background-color: var(--background-color);
    }

    ::-webkit-scrollbar-track {
        border-radius: 1rem;
    }

    ::-webkit-scrollbar-thumb {
        border-radius: 1rem;
        background: #b0b0b0;
        outline: 1px solid var(--background-color);
    }

    #search-content::-webkit-scrollbar {
        width: .5em;
        height: .1em;
        background-color: var(--background-color);
    }
</style>




<style>
     
    header#profileHeader{
      position: sticky;        
      top: 0;
      z-index: 9999;
      background-color: var(--secondary-color);
      box-shadow: 0 4px 6px rgba(0,0,0,.08);
    }
     
    #profileHeader,
    #profileHeader.showHeaderOnTop{
      transform: none !important;
      opacity: 1 !important;
      visibility: visible !important;
    }
  </style>
  




<meta name="description" content="Explore the fascinating world of cluster analysis using R. Discover various clustering techniques, such as hierarchical clustering, k-means clustering, and more, as you delve into the process of grouping similar observations together to uncover patterns and structures in your data.">
<link rel="stylesheet" href="/css/single.css">
<script defer src="/fontawesome-6/all-6.4.2.js"></script>


  
  

  <title>
Cluster Analysis | Ahsan

  </title>
</head>

<body class="light">
  
  
<header id="profileHeader">
    <nav class="pt-3 navbar navbar-expand-lg animate">
        <div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5">
            
            <a class="navbar-brand primary-font text-wrap" href="/">
                
                <img src="/fav.png" width="30" height="30"
                    class="d-inline-block align-top">
                Ahsan
                
            </a>

            
                <div>
                    <input id="search" autocomplete="off" class="form-control mr-sm-2 d-none d-md-block" placeholder='Search this site...'
                        aria-label="Search" oninput="searchOnChange(event)">
                </div>
            

            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
                aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true">
                    <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"></path>
                </svg>
            </button>

            
            <div class="collapse navbar-collapse text-wrap primary-font" id="navbarContent">
                <ul class="navbar-nav ms-auto text-center">
                    
                        <li class="nav-item navbar-text d-block d-md-none">
                            <div class="nav-link">
                                <input id="search" autocomplete="off" class="form-control mr-sm-2" placeholder='Search this site...' aria-label="Search" oninput="searchOnChange(event)">
                            </div>
                        </li>
                    

                    
                    
                        <li class="nav-item navbar-text">
                            <a class="nav-link" href="/#education" title="Education">
                                
                                    <i class="fas fa-graduation-cap"></i>  
                                
                                Education
                            </a>
                        </li>
                    
                        <li class="nav-item navbar-text">
                            <a class="nav-link" href="/#experience" title="Experience">
                                
                                    <i class="fas fa-briefcase"></i>  
                                
                                Experience
                            </a>
                        </li>
                    
                        <li class="nav-item navbar-text">
                            <a class="nav-link" href="/#publications" title="Research">
                                
                                    <i class="fas fa-flask"></i>  
                                
                                Research
                            </a>
                        </li>
                    
                        <li class="nav-item navbar-text">
                            <a class="nav-link" href="/post" title="My Posts">
                                
                                    <i class="fas fa-rss"></i>  
                                
                                Posts
                            </a>
                        </li>
                    
                        <li class="nav-item navbar-text">
                            <a class="nav-link" href="/#contact" title="Contact">
                                
                                    <i class="fas fa-address-card"></i>  
                                
                                Contact
                            </a>
                        </li>
                    
                        <li class="nav-item navbar-text">
                            <a class="nav-link" href="/#youtube" title="Youtube">
                                
                                    <i class="fas fa-chalkboard-teacher"></i>  
                                
                                Youtube
                            </a>
                        </li>
                    

                    
                    <li class="nav-item navbar-text">
                        
                        <div class="text-center">
                            <button id="theme-toggle">
                                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                                </svg>
                                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="5"></circle>
                                    <line x1="12" y1="1" x2="12" y2="3"></line>
                                    <line x1="12" y1="21" x2="12" y2="23"></line>
                                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                    <line x1="1" y1="12" x2="3" y2="12"></line>
                                    <line x1="21" y1="12" x2="23" y2="12"></line>
                                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                                </svg>
                            </button>
                        </div>
                    </li>
                    
                </ul>
            </div>
        </div>
    </nav>
</header>
<div id="content">
<section id="single">
  <div class="container">
    <div class="row justify-content-center">
      
      <div class="col-sm-12 col-md-12 col-lg-9">
        <div class="pr-lg-4">
          <div class="title mb-5">
            <h1 class="text-center mb-4">Cluster Analysis</h1>
            <div class="text-center">
              Md. Ahsanul Islam <small>|</small>
              Sunday, Jul 2, 2023 
              
              <span id="readingTime"> min read</span>
              
            </div>
          </div>

          
          
          <div class="d-block d-lg-none mb-4">
            <aside class="toc">
              <h5>Table of Contents</h5>
              <div class="toc-content"><nav id="TableOfContents">
  <ul>
    <li><a href="#centroid-based-clustering">Centroid-based Clustering</a></li>
    <li><a href="#hierarchical-clustering">Hierarchical Clustering</a></li>
  </ul>

  <ul>
    <li><a href="#step-1-load-data">Step 1: Load Data</a></li>
    <li><a href="#step-2-complete-cases">Step 2: Complete Cases</a></li>
    <li><a href="#step-3-scaling">Step 3: Scaling</a></li>
    <li><a href="#step-4-optimal-number-of-clusters">Step 4: Optimal Number of Clusters</a>
      <ul>
        <li><a href="#elbow-method">Elbow Method</a></li>
        <li><a href="#silhouette-scorewidth">Silhouette Score/Width</a></li>
        <li><a href="#gap-statistic-method">Gap Statistic Method</a></li>
        <li><a href="#combination-of-all">Combination of All</a></li>
      </ul>
    </li>
    <li><a href="#step-5-hierarchical-clustering">Step 5: Hierarchical Clustering</a>
      <ul>
        <li><a href="#step-51-distance">Step 5.1: Distance</a></li>
        <li><a href="#step-52-linkage-criteria">Step 5.2: Linkage Criteria</a></li>
        <li><a href="#step-53-dendrogram">Step 5.3: Dendrogram</a></li>
      </ul>
    </li>
    <li><a href="#step-5-k-means-clustering">Step 5: K-means Clustering</a></li>
  </ul>
</nav></div>
            </aside>
          </div>
          

          
          
          
          
            
          

          

          <article class="page-content p-2">
            <hr>
<h1 id="introduction">Introduction</h1>
<p>Cluster analysis is a data analysis technique that aims to identify and group observations or data points that are homogeneous, meaning they share similar characteristics or properties. It is a data mining technique and is considered an unsupervised learning algorithm that helps reveal underlying patterns and structures within the data.</p>
<p>Cluster analysis is a powerful tool that can be used for a variety of tasks, including:</p>
<ul>
<li>Customer segmentation: Cluster analysis can be used to segment customers into groups based on their purchase behavior, demographics, or other factors. This can help businesses to target their marketing campaigns more effectively.</li>
<li>Fraud detection: Cluster analysis can be used to identify fraudulent transactions by finding groups of transactions that are similar in terms of their characteristics.</li>
<li>Product recommendation: Cluster analysis can be used to recommend products to users based on their past purchase history or other factors.</li>
<li>Anomaly detection: Cluster analysis can be used to identify anomalies or outliers in data. This can be helpful for identifying fraud, detecting system errors, or identifying new trends.</li>
</ul>
<hr>
<h1 id="types">Types</h1>
<p>Centroid-based clustering and Hierarchical clustering are two distinct methods commonly used in clustering analysis.</p>
<p>In centroid-based clustering, the number of clusters is predetermined and specified before the clustering process begins. The algorithm aims to partition the observations into the specified number of clusters by minimizing the within-cluster sum of squares.</p>
<p>In contrast, hierarchical clustering does not require specifying the number of clusters in advance. It generates a tree-like structure called a dendrogram, which shows the hierarchical relationships between the observations at different levels of similarity. By cutting the dendrogram at different heights, we can obtain clusterings for different numbers of clusters, ranging from 1 to the total number of observations.</p>
<p><img src="index.en_insertimage_1.png" alt=" "></p>
<h2 id="centroid-based-clustering">Centroid-based Clustering</h2>
<p>This is a bottom-up approach to clustering, where objects are assigned to non-overlapping clusters based on their proximity to a central point, called a centroid. The most commonly centroid-based clustering algorithms include k-means, k-medoids, and fuzzy c-means.</p>
<p><img src="index.en_insertimage_2.png" alt=" "></p>
<h2 id="hierarchical-clustering">Hierarchical Clustering</h2>
<p>Hierarchical clustering is a top-down approach to clustering that creates a hierarchy of clusters by recursively merging or splitting them based on their similarity. It can be either agglomerative (where objects are merged together to form clusters) or divisive (where clusters are split apart to form smaller clusters).</p>
<p><img src="index.en_insertimage_3.png" alt=" "></p>
<hr>
<h1 id="r-code">R Code</h1>
<h2 id="step-1-load-data">Step 1: Load Data</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">df</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">read.csv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;df_coffee.csv&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><p>Taking a sample of 20 observations for the demonstration purpose:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">set.seed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">df</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">df</span><span style="color:#000">[sample</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#000">nrow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">),</span><span style="color:#000">]</span>
</span></span></code></pre></div><p>Always check descriptive statistics:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">skimr</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rlang</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">skim</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><p>Table: <!-- raw HTML omitted --><!-- raw HTML omitted -->Table 1: Data summary</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left"></th>
          <th style="text-align: left"></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Name</td>
          <td style="text-align: left">df</td>
      </tr>
      <tr>
          <td style="text-align: left">Number of rows</td>
          <td style="text-align: left">20</td>
      </tr>
      <tr>
          <td style="text-align: left">Number of columns</td>
          <td style="text-align: left">16</td>
      </tr>
      <tr>
          <td style="text-align: left">_______________________</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">Column type frequency:</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">character</td>
          <td style="text-align: left">1</td>
      </tr>
      <tr>
          <td style="text-align: left">numeric</td>
          <td style="text-align: left">15</td>
      </tr>
      <tr>
          <td style="text-align: left">________________________</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">Group variables</td>
          <td style="text-align: left">None</td>
      </tr>
  </tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">skim_variable</th>
          <th style="text-align: right">n_missing</th>
          <th style="text-align: right">complete_rate</th>
          <th style="text-align: right">min</th>
          <th style="text-align: right">max</th>
          <th style="text-align: right">empty</th>
          <th style="text-align: right">n_unique</th>
          <th style="text-align: right">whitespace</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Color</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">5</td>
          <td style="text-align: right">12</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">7</td>
          <td style="text-align: right">0</td>
      </tr>
  </tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">skim_variable</th>
          <th style="text-align: right">n_missing</th>
          <th style="text-align: right">complete_rate</th>
          <th style="text-align: right">mean</th>
          <th style="text-align: right">sd</th>
          <th style="text-align: right">p0</th>
          <th style="text-align: right">p25</th>
          <th style="text-align: right">p50</th>
          <th style="text-align: right">p75</th>
          <th style="text-align: right">p100</th>
          <th style="text-align: left">hist</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Aroma</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">7.75</td>
          <td style="text-align: right">0.35</td>
          <td style="text-align: right">7.17</td>
          <td style="text-align: right">7.48</td>
          <td style="text-align: right">7.75</td>
          <td style="text-align: right">8.00</td>
          <td style="text-align: right">8.50</td>
          <td style="text-align: left">▇▆▇▆▃</td>
      </tr>
      <tr>
          <td style="text-align: left">Flavor</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">7.77</td>
          <td style="text-align: right">0.34</td>
          <td style="text-align: right">7.17</td>
          <td style="text-align: right">7.56</td>
          <td style="text-align: right">7.75</td>
          <td style="text-align: right">7.94</td>
          <td style="text-align: right">8.50</td>
          <td style="text-align: left">▃▃▇▃▁</td>
      </tr>
      <tr>
          <td style="text-align: left">Aftertaste</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">7.59</td>
          <td style="text-align: right">0.31</td>
          <td style="text-align: right">7.00</td>
          <td style="text-align: right">7.40</td>
          <td style="text-align: right">7.58</td>
          <td style="text-align: right">7.77</td>
          <td style="text-align: right">8.17</td>
          <td style="text-align: left">▂▆▇▅▂</td>
      </tr>
      <tr>
          <td style="text-align: left">Acidity</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">7.67</td>
          <td style="text-align: right">0.30</td>
          <td style="text-align: right">7.08</td>
          <td style="text-align: right">7.50</td>
          <td style="text-align: right">7.71</td>
          <td style="text-align: right">7.81</td>
          <td style="text-align: right">8.25</td>
          <td style="text-align: left">▂▃▇▃▁</td>
      </tr>
      <tr>
          <td style="text-align: left">Body</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">7.66</td>
          <td style="text-align: right">0.25</td>
          <td style="text-align: right">7.17</td>
          <td style="text-align: right">7.48</td>
          <td style="text-align: right">7.67</td>
          <td style="text-align: right">7.83</td>
          <td style="text-align: right">8.17</td>
          <td style="text-align: left">▂▃▇▃▂</td>
      </tr>
      <tr>
          <td style="text-align: left">Balance</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">7.67</td>
          <td style="text-align: right">0.33</td>
          <td style="text-align: right">7.17</td>
          <td style="text-align: right">7.42</td>
          <td style="text-align: right">7.67</td>
          <td style="text-align: right">7.85</td>
          <td style="text-align: right">8.25</td>
          <td style="text-align: left">▅▃▇▃▃</td>
      </tr>
      <tr>
          <td style="text-align: left">Uniformity</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: left">▁▁▇▁▁</td>
      </tr>
      <tr>
          <td style="text-align: left">Clean.Cup</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: left">▁▁▇▁▁</td>
      </tr>
      <tr>
          <td style="text-align: left">Sweetness</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: right">10.00</td>
          <td style="text-align: left">▁▁▇▁▁</td>
      </tr>
      <tr>
          <td style="text-align: left">Overall</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">7.67</td>
          <td style="text-align: right">0.38</td>
          <td style="text-align: right">7.17</td>
          <td style="text-align: right">7.33</td>
          <td style="text-align: right">7.62</td>
          <td style="text-align: right">7.92</td>
          <td style="text-align: right">8.50</td>
          <td style="text-align: left">▇▃▃▁▃</td>
      </tr>
      <tr>
          <td style="text-align: left">Defects</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: left">▁▁▇▁▁</td>
      </tr>
      <tr>
          <td style="text-align: left">Total.Cup.Points</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">83.77</td>
          <td style="text-align: right">2.09</td>
          <td style="text-align: right">80.17</td>
          <td style="text-align: right">82.50</td>
          <td style="text-align: right">83.70</td>
          <td style="text-align: right">84.89</td>
          <td style="text-align: right">87.58</td>
          <td style="text-align: left">▅▇▇▆▅</td>
      </tr>
      <tr>
          <td style="text-align: left">Moisture.Percentage</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">10.94</td>
          <td style="text-align: right">1.31</td>
          <td style="text-align: right">9.00</td>
          <td style="text-align: right">9.70</td>
          <td style="text-align: right">11.20</td>
          <td style="text-align: right">11.83</td>
          <td style="text-align: right">13.10</td>
          <td style="text-align: left">▇▃▃▇▃</td>
      </tr>
      <tr>
          <td style="text-align: left">Category.One.Defects</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">0.15</td>
          <td style="text-align: right">0.49</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">2.00</td>
          <td style="text-align: left">▇▁▁▁▁</td>
      </tr>
      <tr>
          <td style="text-align: left">Quakers</td>
          <td style="text-align: right">0</td>
          <td style="text-align: right">1</td>
          <td style="text-align: right">0.35</td>
          <td style="text-align: right">1.14</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">0.00</td>
          <td style="text-align: right">5.00</td>
          <td style="text-align: left">▇▁▁▁▁</td>
      </tr>
  </tbody>
</table>
<p>Three of the variables have no variability (standard deviation of zero). So they should be removed:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">df</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">dplyr</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Uniformity&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;Clean.Cup&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;Sweetness&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;Defects&#34;</span><span style="color:#000;font-weight:bold">))</span>
</span></span></code></pre></div><p>We can only use numeric variables in cluster analysis functions in R for now. (There are some advanced techniques that discuss methods related to cluster analysis in mixed data types).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">df_num</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">df[</span><span style="color:#000;font-weight:bold">,</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">ncol</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">]</span>  <span style="color:#8f5902;font-style:italic"># removing the last variable in the dataset which is character type</span>
</span></span></code></pre></div><h2 id="step-2-complete-cases">Step 2: Complete Cases</h2>
<p>Take only complete cases:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">df_com</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">na.omit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_num</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><h2 id="step-3-scaling">Step 3: Scaling</h2>
<p>Scaling the dataset is important because different features may have different scales, and if they are not scaled, then the features with larger scales will have a greater influence on the clustering results.</p>
<p>Common scaling techniques used in clustering include standardization (subtracting the mean and dividing by the standard deviation), normalization (scaling the values to a specific range).</p>
<p><code>\(X_{stand} = \frac{X - \mu_x}{\sigma_x}\)</code><br>
<code>\(X_{norm} = \frac{X - X_{min}}{X_{max}-X_{min}}\)</code><br>
<code>\(E[Y] = E[\Gamma'X]=\Gamma'E[X]=0\)</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># standardization</span>
</span></span><span style="display:flex;"><span><span style="color:#000">df_scaled</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">data.frame</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">scale</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_com</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">center</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">scale</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># normalization</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># df_scaled &lt;- scale(df_com, </span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#                    center = apply(df_com, 2, min), </span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#                    scale = apply(df_com, 2, function(x) {max(x) - min(x)}))  </span>
</span></span></code></pre></div><h2 id="step-4-optimal-number-of-clusters">Step 4: Optimal Number of Clusters</h2>
<p>The optimal number of clusters depends on the specific dataset and the application. However, there are a few methods that can be used to help determine the optimal number of clusters in centroid-based clustering.</p>
<h3 id="elbow-method">Elbow Method</h3>
<p>This method involves plotting the within-cluster sum of squares (WSS) as a function of the number of clusters. The WSS is a measure of how well the data points are clustered together. The elbow method works by looking for the point in the WSS curve where the rate of decrease starts to slow down. This point is often considered to be the optimal number of clusters.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">factoextra</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">fviz_nbclust</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_scaled</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">kmeans</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">method</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;wss&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#000">geom_vline</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">xintercept</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">linetype</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#8f5902;font-style:italic"># add line for better viz</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">subtitle</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Elbow method&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic"># add subtitle</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<h3 id="silhouette-scorewidth">Silhouette Score/Width</h3>
<p>The silhouette score is a measure of how well each data point is clustered with its own cluster compared to other clusters. It ranges from -1 to 1, with a value of 1 indicating that the data point is perfectly clustered with its own cluster, 0 indicating the data point is on the border between the two clusters and a value of -1 indicating that the data point is equally well-clustered with two or more clusters. The optimal number of clusters is often the number that maximizes the average silhouette score.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">fviz_nbclust</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_scaled</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">kmeans</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">method</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;silhouette&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">subtitle</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Silhouette method&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>To compute Silhouette information for a cluster:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">cluster</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">km_res</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">kmeans</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_scaled</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">centers</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span>  <span style="color:#8f5902;font-style:italic"># defining cluster</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">sil</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">silhouette</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">km_res</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">cluster</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">dist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_scaled</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span><span style="color:#000">plot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sil</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">fviz_silhouette</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sil</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">theme_minimal</span><span style="color:#000;font-weight:bold">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>#   cluster size ave.sil.width
# 1       1    8          0.48
# 2       2   12          0.26
</code></pre><!-- raw HTML omitted -->
<p>A positive silhouette coefficient indicates that an observation is well-matched to its own cluster.</p>
<h3 id="gap-statistic-method">Gap Statistic Method</h3>
<p>The gap statistic helps determine the optimal number of clusters by comparing the observed within-cluster dispersion with a reference distribution. The idea is to select the number of clusters that maximizes the gap statistic. A larger gap indicates a more significant deviation from randomness, suggesting a better-defined clustering structure. By comparing the gaps for different numbers of clusters, we can identify the number of clusters that provides the most distinct and meaningful clustering pattern.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">fviz_nbclust</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_scaled</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">kmeans</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">method</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;gap_stat&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">subtitle</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Gap statistic method&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<h3 id="combination-of-all">Combination of All</h3>
<p>But the clever way is to try out different methods and see what majority returns. See <a href="https://statsandr.com/blog/clustering-analysis-k-means-and-hierarchical-clustering-by-hand-and-in-r/#elbow-method">here</a></p>
<p>The <code>parameter</code> package comes to help in this case:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parameters</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">n_clust</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">n_clusters</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_scaled</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000">package</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;easystats&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;NbClust&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;mclust&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000">standardize</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">TRUE</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n_clust</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><pre tabindex="0"><code># # Method Agreement Procedure:
# 
# The choice of 2 clusters is supported by 7 (31.82%) methods out of 22 (Elbow, Silhouette, kl, Duda, Pseudot2, Ratkowsky, Mcclain).
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">plot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n_clust</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<h2 id="step-5-hierarchical-clustering">Step 5: Hierarchical Clustering</h2>
<h3 id="step-51-distance">Step 5.1: Distance</h3>
<h4 id="numeric-data">Numeric Data</h4>
<p>Use the function <code>dist()</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">df_dist_euc</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">dist</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_scaled</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">method</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;euclidian&#39;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># df_dist_max &lt;- dist(df_scaled, method = &#39;maximum&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># df_dist_man &lt;- dist(df_scaled, method = &#39;manhattan&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># df_dist_can &lt;- dist(df_scaled, method = &#39;canberra&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># df_dist_mink &lt;- dist(df_scaled, method = &#39;minkowski&#39;)</span>
</span></span></code></pre></div><h4 id="categorical-data">Categorical Data</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># dist(dummified_data, method = &#34;binary&#34;)</span>
</span></span></code></pre></div><h4 id="gower-distance">Gower Distance</h4>
<p>Gower distance is a similarity measure commonly used for clustering categorical and numerical mixed data. It takes into account the different types of variables and calculates the dissimilarity between observations based on their attribute values.</p>
<p>For categorical variables, Gower distance measures dissimilarity as the proportion of attributes where two observations differ. For numerical variables, it calculates the standardized absolute difference between the values. The Gower distance is then calculated as the weighted sum of the dissimilarities for all variables.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">df</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">dplyr</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">mutate_if</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">is.character</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">as.factor</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic"># convert character to factor</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">df_dist_gower</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">cluster</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">daisy</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">metric</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;gower&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic"># Dissimilarity Matrix Calculation</span>
</span></span></code></pre></div><h3 id="step-52-linkage-criteria">Step 5.2: Linkage Criteria</h3>
<p>Linkage refers to the way in which clusters are merged together. There are several different linkage criteria that can be used, and the choice of linkage criterion can have a significant impact on the results of the clustering -</p>
<ul>
<li>Complete linkage: Maximum distance between two sets</li>
<li>Single linkage: Minimum distance between two sets</li>
<li>Average linkage: Average distance between two sets</li>
<li>Ward&rsquo;s linkage: Minimize the total within cluster variance</li>
</ul>
<p><img src="index.en_insertimage_4.png" alt=" "></p>
<p><img src="index.en_insertimage_5.png" alt=" "></p>
<p>Using the Euclidean distance on the numeric data the following code finds the hierarchical clusters by different linkage methods:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">hclust_single</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">hclust</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_dist_euc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">method</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;single&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">hclust_complete</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">hclust</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_dist_euc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">method</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;complete&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">hclust_average</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">hclust</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_dist_euc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">method</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;average&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">hclust_centroid</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">hclust</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_dist_euc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">method</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;centroid&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">hclust_ward</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">hclust</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_dist_euc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">method</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;ward.D2&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><p>Get the cluster information:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">cutree</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">hclust_ward</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">k</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic"># specify number of clusters</span>
</span></span></code></pre></div><pre tabindex="0"><code># 202 102 112 151 198   4  55  70  98 135   7 183  43 189 140  51 146  25   2 179 
#   1   1   1   1   1   2   2   2   2   1   2   1   2   1   1   2   1   2   2   1
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">cutree</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">hclust_ward</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">h</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0.7</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic"># specify height to cut</span>
</span></span></code></pre></div><pre tabindex="0"><code># 202 102 112 151 198   4  55  70  98 135   7 183  43 189 140  51 146  25   2 179 
#   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20
</code></pre><p>Summary by clusters:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dplyr</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">df_num</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">cluster</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">cutree</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">hclust_ward</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">k</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">cluster</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">summarise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">across</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">everything</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Average</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">mean</span><span style="color:#000;font-weight:bold">)))</span> 
</span></span></code></pre></div><pre tabindex="0"><code># # A tibble: 2 × 12
#   cluster Aroma_Average Flavor_Average Aftertaste_Average Acidity_Average
#     &lt;int&gt;         &lt;dbl&gt;          &lt;dbl&gt;              &lt;dbl&gt;           &lt;dbl&gt;
# 1       1          7.55           7.55               7.37            7.48
# 2       2          8.00           8.03               7.85            7.91
# # ℹ 7 more variables: Body_Average &lt;dbl&gt;, Balance_Average &lt;dbl&gt;,
# #   Overall_Average &lt;dbl&gt;, Total.Cup.Points_Average &lt;dbl&gt;,
# #   Moisture.Percentage_Average &lt;dbl&gt;, Category.One.Defects_Average &lt;dbl&gt;,
# #   Quakers_Average &lt;dbl&gt;
</code></pre><p>Dendrogram will help to visualize as well as to determine the number of clusters to use or the height where to cut.</p>
<h3 id="step-53-dendrogram">Step 5.3: Dendrogram</h3>
<p>Pass the hclust object to the plot function:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">plot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">hclust_ward</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">hang</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">rect.hclust</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">hclust_ward</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">k</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">border</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;blue&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>Using dendextend package:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># install.packages(&#34;dendextend&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dendextend</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">plot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">color_branches</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dend</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">hclust_ward</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">k</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#8f5902;font-style:italic"># specify k, can also use h to specify height</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">plot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">color_branches</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dend</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">hclust_ward</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">k</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>     <span style="color:#8f5902;font-style:italic"># parameters for nodes</span>
</span></span><span style="display:flex;"><span>     <span style="color:#000">nodePar</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">col</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>                    <span style="color:#000">cex</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1.5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.75</span><span style="color:#000;font-weight:bold">),</span> 
</span></span><span style="display:flex;"><span>                    <span style="color:#000">pch</span> <span style="color:#ce5c00;font-weight:bold">=</span>  <span style="color:#0000cf;font-weight:bold">21</span><span style="color:#ce5c00;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">22</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000">bg</span> <span style="color:#ce5c00;font-weight:bold">=</span>  <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;light blue&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;pink&#34;</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000">lab.cex</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0.75</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>                    <span style="color:#000">lab.col</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;tomato&#34;</span><span style="color:#000;font-weight:bold">))</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># function to get color labels; Change color and cut based on number of clusters</span>
</span></span><span style="display:flex;"><span><span style="color:#000">colLab</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#204a87;font-weight:bold">function</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">labelColors</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;#036564&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;#EB6841&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">cut</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">clusMember</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">cutree</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">hclust_ward</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">cut</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">is.leaf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">a</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">attributes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">labCol</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">labelColors[clusMember</span><span style="color:#000">[which</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">names</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">clusMember</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">a</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">label</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">]]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">attr</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;nodePar&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">a</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">nodePar</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">lab.col</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">labCol</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">n</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">hclust_ward</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">color_branches</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">k</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">col</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;#036564&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;#EB6841&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">dendrapply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">colLab</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>  <span style="color:#8f5902;font-style:italic"># applying to all nodes</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">plot</span><span style="color:#000;font-weight:bold">()</span>  <span style="color:#8f5902;font-style:italic"># finally plotting</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;ape&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">plot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">as.phylo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">hclust_ward</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">type</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;unrooted&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">cex</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0.7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">no.margin</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">T</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<h2 id="step-5-k-means-clustering">Step 5: K-means Clustering</h2>
<p>Categorical data cannot be passed to the kmeans() function in R. The kmeans() function uses the Euclidean distance metric to calculate the distance between observations, and this metric is not defined for categorical data.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">km</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">kmeans</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_scaled</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">centers</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic"># centers specify number of clusters</span>
</span></span><span style="display:flex;"><span><span style="color:#000">km</span>
</span></span></code></pre></div><pre tabindex="0"><code># K-means clustering with 2 clusters of sizes 12, 8
# 
# Cluster means:
#        Aroma     Flavor Aftertaste    Acidity       Body    Balance    Overall
# 1 -0.5530586 -0.5889311 -0.6267575 -0.5641766 -0.5577865 -0.6337761 -0.6825517
# 2  0.8295879  0.8833967  0.9401363  0.8462649  0.8366797  0.9506641  1.0238275
#   Total.Cup.Points Moisture.Percentage Category.One.Defects    Quakers
# 1       -0.6521312           0.3165048            0.2043483  0.2052711
# 2        0.9781969          -0.4747571           -0.3065225 -0.3079067
# 
# Clustering vector:
# 202 102 112 151 198   4  55  70  98 135   7 183  43 189 140  51 146  25   2 179 
#   1   1   1   1   1   2   2   2   1   1   2   1   2   1   1   2   1   2   2   1 
# 
# Within cluster sum of squares by cluster:
# [1] 88.09225 26.35215
#  (between_SS / total_SS =  45.2 %)
# 
# Available components:
# 
# [1] &#34;cluster&#34;      &#34;centers&#34;      &#34;totss&#34;        &#34;withinss&#34;     &#34;tot.withinss&#34;
# [6] &#34;betweenss&#34;    &#34;size&#34;         &#34;iter&#34;         &#34;ifault&#34;
</code></pre><p>Visualizing clusters:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">fviz_cluster</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">km</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">df_scaled</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">ggtheme</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">theme_minimal</span><span style="color:#000;font-weight:bold">())</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>Visualizing clusters in terms of variables in the dataset:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ggplot2</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">df_km</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">mutate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_num</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">cluster</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">km</span><span style="color:#ce5c00;font-weight:bold">$</span><span style="color:#000">cluster</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">df_km</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span> <span style="color:#000">ggplot</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Aroma</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Aftertaste</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#000">geom_point</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">aes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">color</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">as.factor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">cluster</span><span style="color:#000;font-weight:bold">)))</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">labs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">color</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Clusters&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">theme_minimal</span><span style="color:#000;font-weight:bold">()</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>Summary on clusters:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#000">df_km</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">group_by</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">cluster</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000">summarise</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">across</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">everything</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Average</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">mean</span><span style="color:#000;font-weight:bold">)))</span> 
</span></span></code></pre></div><pre tabindex="0"><code># # A tibble: 2 × 12
#   cluster Aroma_Average Flavor_Average Aftertaste_Average Acidity_Average
#     &lt;int&gt;         &lt;dbl&gt;          &lt;dbl&gt;              &lt;dbl&gt;           &lt;dbl&gt;
# 1       1          7.56           7.57               7.40            7.50
# 2       2          8.04           8.06               7.88            7.93
# # ℹ 7 more variables: Body_Average &lt;dbl&gt;, Balance_Average &lt;dbl&gt;,
# #   Overall_Average &lt;dbl&gt;, Total.Cup.Points_Average &lt;dbl&gt;,
# #   Moisture.Percentage_Average &lt;dbl&gt;, Category.One.Defects_Average &lt;dbl&gt;,
# #   Quakers_Average &lt;dbl&gt;
</code></pre><hr>
<h1 id="references">References</h1>
<ol>
<li>ISLR</li>
<li><a href="https://uc-r.github.io/kmeans_clustering">https://uc-r.github.io/kmeans_clustering</a></li>
<li><a href="https://statsandr.com/blog/clustering-analysis-k-means-and-hierarchical-clustering-by-hand-and-in-r/#elbow-method">https://statsandr.com/blog/clustering-analysis-k-means-and-hierarchical-clustering-by-hand-and-in-r/#elbow-method</a></li>
<li><a href="https://www.gastonsanchez.com/visually-enforced/how-to/2012/10/03/Dendrograms/">https://www.gastonsanchez.com/visually-enforced/how-to/2012/10/03/Dendrograms/</a></li>
</ol>

          </article>
        </div>
      </div>

      
      <div class="col-sm-12 col-md-12 col-lg-3">
        <div id="stickySideBar" class="sticky-sidebar">
          
          
          <aside class="toc d-none d-lg-block">
            <h5>Table of Contents</h5>
            <div class="toc-content"><nav id="TableOfContents">
  <ul>
    <li><a href="#centroid-based-clustering">Centroid-based Clustering</a></li>
    <li><a href="#hierarchical-clustering">Hierarchical Clustering</a></li>
  </ul>

  <ul>
    <li><a href="#step-1-load-data">Step 1: Load Data</a></li>
    <li><a href="#step-2-complete-cases">Step 2: Complete Cases</a></li>
    <li><a href="#step-3-scaling">Step 3: Scaling</a></li>
    <li><a href="#step-4-optimal-number-of-clusters">Step 4: Optimal Number of Clusters</a>
      <ul>
        <li><a href="#elbow-method">Elbow Method</a></li>
        <li><a href="#silhouette-scorewidth">Silhouette Score/Width</a></li>
        <li><a href="#gap-statistic-method">Gap Statistic Method</a></li>
        <li><a href="#combination-of-all">Combination of All</a></li>
      </ul>
    </li>
    <li><a href="#step-5-hierarchical-clustering">Step 5: Hierarchical Clustering</a>
      <ul>
        <li><a href="#step-51-distance">Step 5.1: Distance</a></li>
        <li><a href="#step-52-linkage-criteria">Step 5.2: Linkage Criteria</a></li>
        <li><a href="#step-53-dendrogram">Step 5.3: Dendrogram</a></li>
      </ul>
    </li>
    <li><a href="#step-5-k-means-clustering">Step 5: K-means Clustering</a></li>
  </ul>
</nav></div>
          </aside>
          

          
          <aside class="tags">
            <h5>Tags</h5>
            <ul class="tags-ul list-unstyled list-inline">
              
              <li class="list-inline-item">
                <a href="https://ahsan.netlify.app/tags/r"
                   target="_blank">
                  R
                </a>
              </li>
              
              <li class="list-inline-item">
                <a href="https://ahsan.netlify.app/tags/cluster-analysis"
                   target="_blank">
                  Cluster Analysis
                </a>
              </li>
              
            </ul>
          </aside>
          

          
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12 col-md-12 col-lg-9 p-4">
        
      </div>
    </div>
  </div>

  <button class="p-2 px-3" onclick="topFunction()" id="topScroll"><i class="fas fa-angle-up"></i></button>
</section>


<div class="progress">
  <div id="scroll-progress-bar" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
</div>
<script src="/js/scrollProgressBar.js"></script>


<script>
  var topScroll = document.getElementById("topScroll");
  window.onscroll = function() { scrollFunction() };
  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) topScroll.style.display = "block";
    else topScroll.style.display = "none";
  }
  function topFunction() { document.body.scrollTop = 0; document.documentElement.scrollTop = 0; }
  let stickySideBarElem = document.getElementById("stickySideBar");
  let stickyNavBar =  false ;
  if (stickyNavBar) {
    let headerElem = document.getElementById("profileHeader");
    let headerHeight = headerElem.offsetHeight + 25;
    stickySideBarElem.style.top = headerHeight + "px";
  } else {
    stickySideBarElem.style.top = "100px";
  }
</script>


<script src="/js/readingTime.js"></script>



  </div><footer>
    
 
 
<div class="container py-3" id="recent-posts">
    
    
    <div class="h3 text-center text-secondary py-3">
        Recent Posts
    </div>
    <div class="row justify-content-center">
        
        <div class="col-lg-4 col-md-6 pt-2">
            <div class="card h-100">
                
                <div class="card-body bg-transparent p-3 shadow-sm">
                    <a href="/post/cluster-analysis/" class="primary-font card-title">
                        <h5 class="card-title bg-transparent" title="Cluster Analysis">Cluster Analysis</h5>
                    </a>
                    <div class="card-text secondary-font">
                        <p>Discover the power of cluster analysis in R with this comprehensive blog post. Learn the essential techniques, interpret the results, and gain valuable insights from your data.</p>
                    </div>
                </div>
                <div class="mt-auto card-footer">
                    <span class="float-start">Jul 2, 2023</span>
                    <a href="/post/cluster-analysis/" class="float-end btn btn-outline-info btn-sm">Read</a>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 col-md-6 pt-2">
            <div class="card h-100">
                
                <div class="card-body bg-transparent p-3 shadow-sm">
                    <a href="/post/manova/" class="primary-font card-title">
                        <h5 class="card-title bg-transparent" title="MANOVA Analysis: Unveiling Multivariate Patterns with R and Python">MANOVA Analysis: …</h5>
                    </a>
                    <div class="card-text secondary-font">
                        <p>MANOVA (Multivariate analysis of variance) is an extension of ANOVA (Analysis of Variance) technique, which is used to compare means across different groups for a single dependent variable. In MANOVA, the dependent variables are correlated, and the analysis takes into account their&hellip;</p>
                    </div>
                </div>
                <div class="mt-auto card-footer">
                    <span class="float-start">May 29, 2023</span>
                    <a href="/post/manova/" class="float-end btn btn-outline-info btn-sm">Read</a>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 col-md-6 pt-2">
            <div class="card h-100">
                
                <div class="card-body bg-transparent p-3 shadow-sm">
                    <a href="/post/r-in-jupyter-notebook/" class="primary-font card-title">
                        <h5 class="card-title bg-transparent" title="Use R in Jupyter Notebook">Use R in Jupyter Notebook</h5>
                    </a>
                    <div class="card-text secondary-font">
                        <p>In this post, I have showed complete procedure of enabling R kernal for Jupyter Notebook, so that you can use R in Jupyter Notebook.</p>
                    </div>
                </div>
                <div class="mt-auto card-footer">
                    <span class="float-start">Jul 19, 2022</span>
                    <a href="/post/r-in-jupyter-notebook/" class="float-end btn btn-outline-info btn-sm">Read</a>
                </div>
            </div>
        </div>
        
    </div>
</div>

<div class="text-center pt-2">
    
    <span class="px-1">
        <a href="https://github.com/mdahsanulhimel" aria-label="github">
            <svg xmlns="http://www.w3.org/2000/svg" width="2.7em" height="2.7em" viewBox="0 0 1792 1792">
                <path id="footer-socialNetworks-github-svg-path"
                    d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5t-203.5 84.5h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-86-13.5q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5h-224q-119 0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5 84.5t84.5 203.5z" />

                <metadata>
                    <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                        xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:dc="http://purl.org/dc/elements/1.1/">
                        <rdf:Description about="https://iconscout.com/legal#licenses"
                            dc:title="Github, Online, Project, Hosting, Square"
                            dc:description="Github, Online, Project, Hosting, Square" dc:publisher="Iconscout"
                            dc:date="2016-12-14" dc:format="image/svg+xml" dc:language="en">
                            <dc:creator>
                                <rdf:Bag>
                                    <rdf:li>Font Awesome</rdf:li>
                                </rdf:Bag>
                            </dc:creator>
                        </rdf:Description>
                    </rdf:RDF>
                </metadata>
            </svg>
        </a>
    </span>
    

    

    

    

    
</div><div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-4 text-center">
            
                <div class="pb-2">
                    <a href="https://ahsan.netlify.app/" title="Ahsan">
                        <img alt="Footer logo" src="/fav.png"
                            height="40px" width="40px">
                    </a>
                </div>
            
            &copy; 2025  All rights reserved
            <div class="text-secondary">
                Made with
                <span class="text-danger">
                    &#10084;
                </span>
                and
                <a href="https://github.com/gurusabarish/hugo-profile" target="_blank"
                    title="Designed and developed by gurusabarish">
                    Hugo Profile
                </a>
            </div>
        </div>
    </div>
</div>
</footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
<script>
    if (document.body.className.includes("dark")) {
        document.body.classList.remove('dark');
        localStorage.setItem("pref-theme", 'light');
    }
</script>


<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })

</script>


    <script src="/js/search.js"></script>





<!-- MathJax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js" integrity="sha384-M5jmNxKC9EVnuqeMwRHvFuYUE8Hhp0TgBruj/GZRkYtiMrCRgH7yvv5KY+Owi7TW" crossorigin="anonymous"></script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['\\(','\\)']],
        displayMath: [['$$','$$'], ['\[','\]']],
        processEscapes: true,
        processEnvironments: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        TeX: { equationNumbers: { autoNumber: "AMS" },
             extensions: ["AMSmath.js", "AMSsymbols.js"] }
      }
    });
</script>








  <section id="search-content" class="py-2">
    <div class="container" id="search-results"></div>
  </section>
</body>

</html>
